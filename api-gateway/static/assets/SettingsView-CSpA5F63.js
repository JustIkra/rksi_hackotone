import{l as _,m as v,n as V,v as y,w as a,r as u,o as h,a as t,f as o,y as E,A as b,u as C,e as x,E as m}from"./index-z4An-3zU.js";import{A as z}from"./AppLayout-Da398sgp.js";import{_ as A}from"./_plugin-vue_export-helper-DlAUqK2U.js";const S={class:"settings-container"},q={class:"card settings-card"},B={__name:"SettingsView",setup(M){const w=_(),l=v(null),s=V({currentPassword:"",newPassword:"",confirmPassword:""}),f={currentPassword:[{required:!0,message:"Введите текущий пароль",trigger:"blur"}],newPassword:[{required:!0,validator:(d,e,r)=>{e===""?r(new Error("Введите новый пароль")):e.length<8?r(new Error("Пароль должен быть не менее 8 символов")):/[a-zA-Z]/.test(e)?/\d/.test(e)?r():r(new Error("Пароль должен содержать хотя бы одну цифру")):r(new Error("Пароль должен содержать хотя бы одну букву"))},trigger:"blur"}],confirmPassword:[{required:!0,validator:(d,e,r)=>{e===""?r(new Error("Подтвердите новый пароль")):e!==s.newPassword?r(new Error("Пароли не совпадают")):r()},trigger:"blur"}]},c=()=>{s.currentPassword="",s.newPassword="",s.confirmPassword="",l.value?.clearValidate()},p=async()=>{l.value&&await l.value.validate(async d=>{if(d)try{await w.changePassword(s.currentPassword,s.newPassword),m.success("Пароль успешно изменен"),c()}catch{const r=w.error||"Ошибка смены пароля";m.error(r)}})};return(d,e)=>{const r=u("el-input"),i=u("el-form-item"),P=u("el-button"),g=u("el-form");return h(),y(z,null,{default:a(()=>[t("div",S,[e[5]||(e[5]=t("div",{class:"page-header"},[t("h1",{class:"page-title"}," Настройки "),t("p",{class:"page-subtitle"}," Управление учетной записью ")],-1)),t("div",q,[e[4]||(e[4]=t("div",{class:"card-header"},[t("h2",{class:"card-title"}," Смена пароля "),t("p",{class:"card-subtitle"}," Обновите пароль для вашей учетной записи ")],-1)),o(g,{ref_key:"formRef",ref:l,model:s,rules:f,"label-position":"top",onSubmit:E(p,["prevent"])},{default:a(()=>[o(i,{label:"Текущий пароль",prop:"currentPassword"},{default:a(()=>[o(r,{modelValue:s.currentPassword,"onUpdate:modelValue":e[0]||(e[0]=n=>s.currentPassword=n),type:"password",placeholder:"Введите текущий пароль",size:"large","show-password":"",autocomplete:"current-password"},null,8,["modelValue"])]),_:1}),o(i,{label:"Новый пароль",prop:"newPassword"},{default:a(()=>[o(r,{modelValue:s.newPassword,"onUpdate:modelValue":e[1]||(e[1]=n=>s.newPassword=n),type:"password",placeholder:"Введите новый пароль (минимум 8 символов, буква и цифра)",size:"large","show-password":"",autocomplete:"new-password"},null,8,["modelValue"])]),_:1}),o(i,{label:"Подтверждение нового пароля",prop:"confirmPassword"},{default:a(()=>[o(r,{modelValue:s.confirmPassword,"onUpdate:modelValue":e[2]||(e[2]=n=>s.confirmPassword=n),type:"password",placeholder:"Повторите новый пароль",size:"large","show-password":"",autocomplete:"new-password",onKeyup:b(p,["enter"])},null,8,["modelValue"])]),_:1}),o(i,{class:"form-actions"},{default:a(()=>[o(P,{type:"primary",size:"large",loading:C(w).loading,onClick:p},{default:a(()=>[...e[3]||(e[3]=[x(" Сменить пароль ",-1)])]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])])])]),_:1})}}},I=A(B,[["__scopeId","data-v-52b9e18a"]]);export{I as default};
