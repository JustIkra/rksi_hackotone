import{l as V,m as v,n as y,v as h,w as t,r as n,o as E,a as u,d as o,y as C,A as b,u as x,f as z,E as m}from"./index-BtALiBmK.js";import{A}from"./AppLayout-kQjWe9-A.js";import{_ as S}from"./_plugin-vue_export-helper-DlAUqK2U.js";const q={class:"settings-container"},B={__name:"SettingsView",setup(M){const w=V(),l=v(null),s=y({currentPassword:"",newPassword:"",confirmPassword:""}),f={currentPassword:[{required:!0,message:"Введите текущий пароль",trigger:"blur"}],newPassword:[{required:!0,validator:(d,e,r)=>{e===""?r(new Error("Введите новый пароль")):e.length<8?r(new Error("Пароль должен быть не менее 8 символов")):/[a-zA-Z]/.test(e)?/\d/.test(e)?r():r(new Error("Пароль должен содержать хотя бы одну цифру")):r(new Error("Пароль должен содержать хотя бы одну букву"))},trigger:"blur"}],confirmPassword:[{required:!0,validator:(d,e,r)=>{e===""?r(new Error("Подтвердите новый пароль")):e!==s.newPassword?r(new Error("Пароли не совпадают")):r()},trigger:"blur"}]},c=()=>{s.currentPassword="",s.newPassword="",s.confirmPassword="",l.value?.clearValidate()},p=async()=>{l.value&&await l.value.validate(async d=>{if(d)try{await w.changePassword(s.currentPassword,s.newPassword),m.success("Пароль успешно изменен"),c()}catch{const r=w.error||"Ошибка смены пароля";m.error(r)}})};return(d,e)=>{const r=n("el-input"),i=n("el-form-item"),_=n("el-button"),P=n("el-form"),g=n("el-card");return E(),h(A,null,{default:t(()=>[u("div",q,[o(g,{class:"settings-card"},{header:t(()=>[...e[3]||(e[3]=[u("div",{class:"card-header"},[u("h2",null,"Настройки"),u("p",null,"Смена пароля")],-1)])]),default:t(()=>[o(P,{ref_key:"formRef",ref:l,model:s,rules:f,"label-position":"top",onSubmit:C(p,["prevent"])},{default:t(()=>[o(i,{label:"Текущий пароль",prop:"currentPassword"},{default:t(()=>[o(r,{modelValue:s.currentPassword,"onUpdate:modelValue":e[0]||(e[0]=a=>s.currentPassword=a),type:"password",placeholder:"Введите текущий пароль",size:"large","show-password":"",autocomplete:"current-password"},null,8,["modelValue"])]),_:1}),o(i,{label:"Новый пароль",prop:"newPassword"},{default:t(()=>[o(r,{modelValue:s.newPassword,"onUpdate:modelValue":e[1]||(e[1]=a=>s.newPassword=a),type:"password",placeholder:"Введите новый пароль (минимум 8 символов, буква и цифра)",size:"large","show-password":"",autocomplete:"new-password"},null,8,["modelValue"])]),_:1}),o(i,{label:"Подтверждение нового пароля",prop:"confirmPassword"},{default:t(()=>[o(r,{modelValue:s.confirmPassword,"onUpdate:modelValue":e[2]||(e[2]=a=>s.confirmPassword=a),type:"password",placeholder:"Повторите новый пароль",size:"large","show-password":"",autocomplete:"new-password",onKeyup:b(p,["enter"])},null,8,["modelValue"])]),_:1}),o(i,null,{default:t(()=>[o(_,{type:"primary",size:"large",loading:x(w).loading,onClick:p},{default:t(()=>[...e[4]||(e[4]=[z(" Сменить пароль ",-1)])]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])]),_:1})])]),_:1})}}},I=S(B,[["__scopeId","data-v-f96b4346"]]);export{I as default};
