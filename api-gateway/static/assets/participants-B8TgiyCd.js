import{P as g,m as o,D as s}from"./index-CLa57XdF.js";import{p as c}from"./participants-8uyslejd.js";const P=g("participants",()=>{const n=o([]),i=o(null),r=o(!1),l=o(null),v=o({total:0,page:1,size:20,totalPages:0});async function f(t={}){r.value=!0,l.value=null;try{const a=await c.search(t);return n.value=a.items,v.value={total:a.total,page:a.page,size:a.size,totalPages:Math.ceil(a.total/a.size)},a}catch(a){const e=s(a,"Ошибка загрузки участников");throw l.value=e.message,a.normalizedError=e,a}finally{r.value=!1}}async function d(t){r.value=!0,l.value=null;try{const a=await c.getById(t);return i.value=a,a}catch(a){const e=s(a,"Ошибка загрузки участника");throw l.value=e.message,a.normalizedError=e,a}finally{r.value=!1}}async function m(t){r.value=!0,l.value=null;try{const a=await c.create(t);return n.value.unshift(a),a}catch(a){const e=s(a,"Ошибка создания участника");throw l.value=e.message,a.normalizedError=e,a}finally{r.value=!1}}async function p(t,a){r.value=!0,l.value=null;try{const e=await c.update(t,a),u=n.value.findIndex(z=>z.id===t);return u!==-1&&(n.value[u]=e),i.value?.id===t&&(i.value=e),e}catch(e){const u=s(e,"Ошибка обновления участника");throw l.value=u.message,e.normalizedError=u,e}finally{r.value=!1}}async function y(t){r.value=!0,l.value=null;try{await c.delete(t),n.value=n.value.filter(a=>a.id!==t),i.value?.id===t&&(i.value=null)}catch(a){const e=s(a,"Ошибка удаления участника");throw l.value=e.message,a.normalizedError=e,a}finally{r.value=!1}}return{participants:n,currentParticipant:i,loading:r,error:l,pagination:v,searchParticipants:f,getParticipant:d,createParticipant:m,updateParticipant:p,deleteParticipant:y}});export{P as u};
