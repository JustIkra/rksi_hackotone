import{N as l,a2 as h,m as c,D as u}from"./index-pQsDL8Mh.js";const p={async create(e){return(await l.post("/participants",e)).data},async search(e={}){return(await l.get("/participants",{params:e})).data},async getById(e){return(await l.get(`/participants/${e}`)).data},async update(e,r){return(await l.put(`/participants/${e}`,r)).data},async delete(e){return(await l.delete(`/participants/${e}`)).data},async getReports(e){return(await l.get(`/participants/${e}/reports`)).data},async getMetrics(e){return(await l.get(`/participants/${e}/metrics`)).data},async updateMetric(e,r,n){return(await l.put(`/participants/${e}/metrics/${r}`,n)).data}},P=h("participants",()=>{const e=c([]),r=c(null),n=c(!1),i=c(null),d=c({total:0,page:1,size:20,totalPages:0});async function v(s={}){n.value=!0,i.value=null;try{const a=await p.search(s);return e.value=a.items,d.value={total:a.total,page:a.page,size:a.size,totalPages:Math.ceil(a.total/a.size)},a}catch(a){const t=u(a,"Ошибка загрузки участников");throw i.value=t.message,a.normalizedError=t,a}finally{n.value=!1}}async function f(s){n.value=!0,i.value=null;try{const a=await p.getById(s);return r.value=a,a}catch(a){const t=u(a,"Ошибка загрузки участника");throw i.value=t.message,a.normalizedError=t,a}finally{n.value=!1}}async function y(s){n.value=!0,i.value=null;try{const a=await p.create(s);return e.value.unshift(a),a}catch(a){const t=u(a,"Ошибка создания участника");throw i.value=t.message,a.normalizedError=t,a}finally{n.value=!1}}async function m(s,a){n.value=!0,i.value=null;try{const t=await p.update(s,a),o=e.value.findIndex(w=>w.id===s);return o!==-1&&(e.value[o]=t),r.value?.id===s&&(r.value=t),t}catch(t){const o=u(t,"Ошибка обновления участника");throw i.value=o.message,t.normalizedError=o,t}finally{n.value=!1}}async function g(s){n.value=!0,i.value=null;try{await p.delete(s),e.value=e.value.filter(a=>a.id!==s),r.value?.id===s&&(r.value=null)}catch(a){const t=u(a,"Ошибка удаления участника");throw i.value=t.message,a.normalizedError=t,a}finally{n.value=!1}}return{participants:e,currentParticipant:r,loading:n,error:i,pagination:d,searchParticipants:v,getParticipant:f,createParticipant:y,updateParticipant:m,deleteParticipant:g}});export{p,P as u};
