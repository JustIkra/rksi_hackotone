import{O as o,P as h,m as l,D as p,H as z,T as P}from"./index-pq0ppcP1.js";const d={async create(a){return(await o.post("/participants",a)).data},async search(a={}){return(await o.get("/participants",{params:a})).data},async getById(a){return(await o.get(`/participants/${a}`)).data},async update(a,t){return(await o.put(`/participants/${a}`,t)).data},async delete(a){return(await o.delete(`/participants/${a}`)).data},async getReports(a){return(await o.get(`/participants/${a}/reports`)).data},async getMetrics(a){return(await o.get(`/participants/${a}/metrics`)).data},async updateMetric(a,t,r){return(await o.put(`/participants/${a}/metrics/${t}`,r)).data}},$=h("participants",()=>{const a=l([]),t=l(null),r=l(!1),s=l(null),c=l({total:0,page:1,size:20,totalPages:0});async function v(i={}){r.value=!0,s.value=null;try{const e=await d.search(i);return a.value=e.items,c.value={total:e.total,page:e.page,size:e.size,totalPages:Math.ceil(e.total/e.size)},e}catch(e){const n=p(e,"Ошибка загрузки участников");throw s.value=n.message,e.normalizedError=n,e}finally{r.value=!1}}async function f(i){r.value=!0,s.value=null;try{const e=await d.getById(i);return t.value=e,e}catch(e){const n=p(e,"Ошибка загрузки участника");throw s.value=n.message,e.normalizedError=n,e}finally{r.value=!1}}async function w(i){r.value=!0,s.value=null;try{const e=await d.create(i);return a.value.unshift(e),e}catch(e){const n=p(e,"Ошибка создания участника");throw s.value=n.message,e.normalizedError=n,e}finally{r.value=!1}}async function y(i,e){r.value=!0,s.value=null;try{const n=await d.update(i,e),u=a.value.findIndex(g=>g.id===i);return u!==-1&&(a.value[u]=n),t.value?.id===i&&(t.value=n),n}catch(n){const u=p(n,"Ошибка обновления участника");throw s.value=u.message,n.normalizedError=u,n}finally{r.value=!1}}async function m(i){r.value=!0,s.value=null;try{await d.delete(i),a.value=a.value.filter(e=>e.id!==i),t.value?.id===i&&(t.value=null)}catch(e){const n=p(e,"Ошибка удаления участника");throw s.value=n.message,e.normalizedError=n,e}finally{r.value=!1}}return{participants:a,currentParticipant:t,loading:r,error:s,pagination:c,searchParticipants:v,getParticipant:f,createParticipant:w,updateParticipant:y,deleteParticipant:m}});function E(a,t){let r=0;return function(...s){const c=Date.now();c-r>=t&&(r=c,a.apply(this,s))}}function x(a=768){const t=l(window.innerWidth<=a),s=E(()=>{t.value=window.innerWidth<=a},100);return z(()=>window.addEventListener("resize",s)),P(()=>window.removeEventListener("resize",s)),{isMobile:t}}export{x as a,d as p,$ as u};
