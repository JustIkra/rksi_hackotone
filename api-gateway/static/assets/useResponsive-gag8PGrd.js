import{O as o,a7 as h,m as l,D as u,H as z,S as P}from"./index-B7EJ_Eo5.js";const p={async create(a){return(await o.post("/participants",a)).data},async search(a={}){return(await o.get("/participants",{params:a})).data},async getById(a){return(await o.get(`/participants/${a}`)).data},async update(a,t){return(await o.put(`/participants/${a}`,t)).data},async delete(a){return(await o.delete(`/participants/${a}`)).data},async getReports(a){return(await o.get(`/participants/${a}/reports`)).data},async getMetrics(a){return(await o.get(`/participants/${a}/metrics`)).data},async updateMetric(a,t,r){return(await o.put(`/participants/${a}/metrics/${t}`,r)).data}},$=h("participants",()=>{const a=l([]),t=l(null),r=l(!1),i=l(null),d=l({total:0,page:1,size:20,totalPages:0});async function v(s={}){r.value=!0,i.value=null;try{const e=await p.search(s);return a.value=e.items,d.value={total:e.total,page:e.page,size:e.size,totalPages:Math.ceil(e.total/e.size)},e}catch(e){const n=u(e,"Ошибка загрузки участников");throw i.value=n.message,e.normalizedError=n,e}finally{r.value=!1}}async function f(s){r.value=!0,i.value=null;try{const e=await p.getById(s);return t.value=e,e}catch(e){const n=u(e,"Ошибка загрузки участника");throw i.value=n.message,e.normalizedError=n,e}finally{r.value=!1}}async function w(s){r.value=!0,i.value=null;try{const e=await p.create(s);return a.value.unshift(e),e}catch(e){const n=u(e,"Ошибка создания участника");throw i.value=n.message,e.normalizedError=n,e}finally{r.value=!1}}async function y(s,e){r.value=!0,i.value=null;try{const n=await p.update(s,e),c=a.value.findIndex(g=>g.id===s);return c!==-1&&(a.value[c]=n),t.value?.id===s&&(t.value=n),n}catch(n){const c=u(n,"Ошибка обновления участника");throw i.value=c.message,n.normalizedError=c,n}finally{r.value=!1}}async function m(s){r.value=!0,i.value=null;try{await p.delete(s),a.value=a.value.filter(e=>e.id!==s),t.value?.id===s&&(t.value=null)}catch(e){const n=u(e,"Ошибка удаления участника");throw i.value=n.message,e.normalizedError=n,e}finally{r.value=!1}}return{participants:a,currentParticipant:t,loading:r,error:i,pagination:d,searchParticipants:v,getParticipant:f,createParticipant:w,updateParticipant:y,deleteParticipant:m}});function M(a=768){const t=l(window.innerWidth<=a),r=()=>{t.value=window.innerWidth<=a};return z(()=>window.addEventListener("resize",r)),P(()=>window.removeEventListener("resize",r)),{isMobile:t}}export{M as a,p,$ as u};
